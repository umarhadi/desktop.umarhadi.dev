"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3989,3456],{73989:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var a=n(85893);let r=n(964).ZP.div.withConfig({componentId:"sc-1d70034d-0"})(['&.drop{&::before{color:#f1f1f1;content:"Drop rom file here";display:flex;font-size:16px;font-weight:600;height:100%;left:0;place-content:center;place-items:center;position:absolute;top:0;width:100%;}}']);var i=n(1864),l=n(67294),o=n(16635),c=n(81338),s=n(34772),u=n(59140),d=n(78743),f=n(26550),w=n(27972),m=n(93456),p=n(48764).Buffer;let v=e=>Object.entries(o.P).find(([,{ext:t}])=>t.includes(e))||[];var S=({containerRef:e,id:t,loading:n,setLoading:a,url:r})=>{let{exists:o,mkdirRecursive:S,readFile:h,updateFolder:b,writeFile:E}=(0,u.o)(),y=(0,c.Z)(),{linkElement:F,processes:{[t]:{closing:$=!1,libs:_=[]}={}}={}}=(0,d.z)(),{prependFileToTitle:g}=(0,s.Z)(t),T=(0,l.useRef)(),k=(0,l.useRef)(""),J=(0,l.useCallback)(async()=>{var t,n,l;if(!r)return;if(null===(t=e.current)||void 0===t||t.classList.remove("drop"),k.current){if(k.current!==r){k.current="";try{null===(n=(l=window).EJS_terminate)||void 0===n||n.call(l)}catch{}if(e.current){let t=document.createElement("div");t.id="emulator",[...e.current.children].forEach(e=>e.remove()),e.current.append(t),J()}}return}k.current=r,window.EJS_gameName=(0,i.basename)(r,(0,i.extname)(r));let[c,{core:s="",zip:u=!1}={}]=v((0,w.RT)(r)),d=await h(r);window.EJS_gameUrl=(0,w.YS)(u?p.from(await (0,m.zipAsync)({[(0,i.basename)(r)]:d})):d),window.EJS_core=s;let F=`${(0,i.basename)(r)}.sav`,$=(0,i.join)(f.Tl,F);window.EJS_onGameStart=({detail:{emulator:e}})=>{(async()=>{if(await o($)){var t;null===(t=e.loadState)||void 0===t||t.call(e,await h($))}a(!1),y(window.FS,"EmulatorJs"),T.current=e})()},window.EJS_onSaveState=({screenshot:e,state:t})=>{var n,a;null===(n=(a=window).EJS_terminate)||void 0===n||n.call(a);let r=async()=>{if(await o(f.Tl)||await S(f.Tl),await E($,p.from(t),!0)){let t=(0,i.join)(f.Xo,f.Tl),n=(0,i.join)(f.Xo,`${$}${f.Qy}`);await o(t)||(await S(t),b((0,i.dirname)(f.Tl))),await E(n,p.from(e),!0),b(f.Tl,F)}};t&&r()},window.EJS_player="#emulator",window.EJS_biosUrl="",window.EJS_pathtodata="Program Files/EmulatorJs/",window.EJS_startOnLoaded=!0,window.EJS_RESET_VARS=!0,window.EJS_Buttons={cacheManage:!1,loadState:!1,quickLoad:!1,quickSave:!1,saveState:!1,screenRecord:!1,screenshot:!1},await (0,w.mb)(_,void 0,!0),g(`${window.EJS_gameName} (${c})`)},[e,o,_,S,y,g,h,a,b,r,E]);(0,l.useEffect)(()=>{if(r)J();else{var t;a(!1),y(window.FS,"EmulatorJs"),null===(t=e.current)||void 0===t||t.classList.add("drop")}},[e,J,y,a,r]),(0,l.useEffect)(()=>{if(!n){var a;let n=null===(a=e.current)||void 0===a?void 0:a.querySelector("canvas");n instanceof HTMLCanvasElement&&F(t,"peekElement",n)}return()=>{if(!n&&$){var e,t;null===(t=T.current)||void 0===t||null===(e=t.elements.buttons.saveState)||void 0===e||e.click()}}},[$,e,t,F,n])},h=n(50834),b=({id:e})=>(0,a.jsx)(h.Z,{StyledComponent:r,id:e,useHook:S,children:(0,a.jsx)("div",{id:"emulator"})})},50834:function(e,t,n){var a=n(85893),r=n(5152),i=n.n(r),l=n(67294),o=n(54944),c=n(78743);let s=i()(()=>n.e(446).then(n.bind(n,60446)),{loadableGenerated:{webpack:()=>[60446]}});t.Z=(0,l.memo)(({id:e,useHook:t,StyledComponent:n,children:r})=>{let{processes:{[e]:{url:i=""}={}}}=(0,c.z)(),u=(0,l.useRef)(null),[d,f]=(0,l.useState)(!0),w=(0,l.useMemo)(()=>({contain:"strict",visibility:d?"hidden":"visible"}),[d]);return t({containerRef:u,id:e,loading:d,setLoading:f,url:i}),(0,a.jsxs)(a.Fragment,{children:[d&&(0,a.jsx)(s,{}),(0,a.jsx)(n,{ref:u,style:w,...(0,o.Z)({id:e}),children:r})]})})},81338:function(e,t,n){var a=n(67294),r=n(59140);t.Z=()=>{let{mountEmscriptenFs:e,unMapFs:t,updateFolder:n}=(0,r.o)(),i=(0,a.useRef)();return(0,a.useEffect)(()=>()=>{if(i.current){let e=i.current;i.current="";try{t(e,!0).then(()=>n("/",void 0,e))}catch{}}},[t,n]),(0,a.useCallback)(async(t,a)=>{if(!t)return;let r="";try{r=await e(t,a)}catch{}r&&(n("/",r),i.current=r)},[e,n])}},54944:function(e,t,n){var a=n(1864),r=n(67294),i=n(46013),l=n(36094),o=n(41893),c=n(59140),s=n(78743),u=n(12691),d=n(26550),f=n(27972);t.Z=({callback:e,directory:t=d.Ll,id:n,onDragLeave:w,onDragOver:m,updatePositions:p})=>{let{url:v}=(0,s.z)(),{iconPositions:S,sortOrders:h,setIconPositions:b}=(0,u.k)(),{mkdirRecursive:E,updateFolder:y,writeFile:F}=(0,c.o)(),$=(0,r.useCallback)(async(e,t,r)=>{if(n){if(t){let i=(0,a.join)(d.Ll,e);if(await E(d.Ll),await F(i,t,!0))return r===o.v.UPDATE_URL&&v(n,i),y(d.Ll,e),(0,a.basename)(i)}else r===o.v.UPDATE_URL&&v(n,e)}return""},[n,E,y,v,F]),{openTransferDialog:_}=(0,i.Z)();return{onDragLeave:w,onDragOver:e=>{null==m||m(e),(0,f.nK)(e)},onDrop:r=>{if(!d.my.has((0,f.RT)(t))){if(p&&r.target instanceof HTMLElement){let{files:e,text:n}=(0,l.p4)(r);if(0===e.length&&""===n)return;let i={x:r.clientX,y:r.clientY},o=[];if(n){try{o=JSON.parse(n)}catch{}if(!Array.isArray(o))return;let[e]=o;if(!e||e.startsWith(t)&&(0,a.basename)(e)===(0,a.relative)(t,e))return;o=o.map(e=>(0,a.basename)(e))}else o=e instanceof FileList?[...e].map(e=>e.name):[...e].map(e=>{var t;return(null===(t=e.getAsFile())||void 0===t?void 0:t.name)||""}).filter(Boolean);o=o.map(e=>{if(!S[`${t}/${e}`])return e;let n=0,r="";do n+=1,r=`${t}/${(0,a.basename)(e,(0,a.extname)(e))} (${n})${(0,a.extname)(e)}`;while(S[r]);return(0,a.basename)(r)}),(0,f.vi)(t,r.target,S,h,i,o,b)}(0,l.WG)(r,e||$,t,_,!!n)}}}}},34772:function(e,t,n){var a=n(67294),r=n(78743),i=n(28272),l=n(26550);t.Z=e=>{let{title:t}=(0,r.z)(),[n]=e.split(l.CC),{title:o}=i.Z[n]||{};return{appendFileToTitle:(0,a.useCallback)((n,a)=>{let r=n?` - ${n}${a?` ${l.xy}`:""}`:"";t(e,`${o}${r}`)},[e,o,t]),prependFileToTitle:(0,a.useCallback)((n,a,r)=>{let i=n?`${a?`${l.xy} `:""}${n}${r?" ":" - "}`:"";t(e,`${i}${o}`)},[e,o,t])}}},93456:function(e,t,n){n.d(t,{addEntryToZippable:function(){return c},addFileToZip:function(){return d},createZippable:function(){return o},isFileInZip:function(){return f},unarchive:function(){return w},unzip:function(){return s},zipAsync:function(){return u}});var a=n(1864),r=n(27972),i=n(26550),l=n(48764).Buffer;let o=(e,t)=>e.split("/").reduceRight((e,t)=>({[t]:e}),[t,i.BF]),c=(e,t)=>{let[[n,a]]=Object.entries(t);return e[n]=n in e?c(e[n],t[n]):a,e},s=e=>new Promise((t,a)=>{n.e(3778).then(n.bind(n,93778)).then(({unzip:n})=>n(e,(e,n)=>e?a(e):t(n)))}),u=(e,t=i.BF)=>new Promise((a,r)=>{n.e(3778).then(n.bind(n,93778)).then(({zip:n})=>n(e,t,(e,t)=>e?r(e):a(t)))}),d=async(e,t,n,a)=>l.from(await u(c(e.length>0&&await s(e)||{},o(n,await a(t))))),f=(e,t)=>new Promise((a,r)=>{n.e(3778).then(n.bind(n,93778)).then(({unzip:n})=>n(e,(e,n)=>e?r(e):a(Object.keys(n).includes(t))))}),w=async(e,t)=>{if(window.SevenZip||await (0,r.mb)(["System/7zip/7zz.es6.js"]),!window.SevenZip)return{};let n=await window.SevenZip(),i=(0,a.basename)(e),o=(0,a.join)("/",(0,a.basename)(e,(0,a.extname)(e)));n.FS.mkdir(o),n.FS.chdir(o);let c=n.FS.open(i,"w+");n.FS.write(c,t,0,t.length),n.FS.close(c),n.callMain(["-y","x",i]);let s=n.FS.readdir(o),u=e=>(t,r)=>{if([".","..",i].includes(r))return t;let c=(0,a.join)(e,r),s=c.replace(o,"");try{n.FS.chmod(c,511)}catch{}return Object.assign(t,n.FS.isDir(n.FS.stat(c).mode)?{[(0,a.join)(s,"/")]:l.from(""),...n.FS.readdir(c).reduce(u(c),{})}:{[s]:n.FS.readFile(c,{flags:"r"})}),t};return s.reduce(u(o),{})}}}]);