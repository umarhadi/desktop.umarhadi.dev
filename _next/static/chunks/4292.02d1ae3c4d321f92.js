"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4292],{4292:function(e,i,n){n.r(i),n.d(i,{default:function(){return p}});var l=n(85893),t=n(1864),r=n(67294);let a=n(964).ZP.div.withConfig({componentId:"sc-16d5cff3-0"})(["#vimjs-canvas{image-rendering:pixelated;}#vimjs-container{height:100%;width:100%;}#vimjs-file{display:none;}#vimjs-font-test{position:absolute;visibility:hidden;}"]);var o=n(81338),u=n(54944),s=n(34772),d=n(59140),c=n(78743),v=n(26550),m=n(27972),f=n(48764).Buffer,p=({id:e})=>{let{closeWithTransition:i,processes:{[e]:n}}=(0,c.z)(),{readFile:p,updateFolder:w,writeFile:h}=(0,d.o)(),b=(0,o.Z)(),{prependFileToTitle:$}=(0,s.Z)(e),{libs:y=[],url:M=""}=n||{},[V,g]=(0,r.useState)([]),j=(0,r.useRef)(!1),x=(0,r.useCallback)(async()=>{var n,l,r;let a=M||v.$Z,[,...o]=a.split("/"),u="";1===o.length&&(u="/root"),window.VimWrapperModule={},await (0,m.mb)(y,!1,!!window.VimWrapperModule);let s=M?await p(a):f.from("");null===(r=window.VimWrapperModule)||void 0===r||null===(l=r.init)||void 0===l||l.call(r,{VIMJS_ALLOW_EXIT:!0,arguments:[`${u}${a}`],containerWindow:null===(n=document.querySelector("#vimjs-container"))||void 0===n?void 0:n.closest("section"),memoryInitializerPrefixURL:"/Program Files/Vim.js/",postRun:[()=>{var e,i;j.current=!1,b(null===(i=window.VimWrapperModule)||void 0===i?void 0:null===(e=i.VimModule)||void 0===e?void 0:e.FS,"Vim")}],preRun:[()=>{let e="";[u,...o].forEach((i,n,{[n+1]:l})=>{var t,r,a,u,d,c;l&&n+1!==o.length?(null===(a=window.VimWrapperModule)||void 0===a||null===(r=a.VimModule)||void 0===r||null===(t=r.FS_createPath)||void 0===t||t.call(r,e,l,!0,!0),e+=`/${l}`):e?null===(c=window.VimWrapperModule)||void 0===c||null===(d=c.VimModule)||void 0===d||null===(u=d.FS_createDataFile)||void 0===u||u.call(d,e,i,s,!0,!0):e=i})}],print:console.info,printErr:console.info,quitCallback:()=>i(e),writeCallback:e=>g(i=>[...i,{buffer:f.from(e),url:a}])}),$((0,t.basename)(a))},[i,e,y,b,$,p,M]);return(0,r.useEffect)(()=>{V.length>0&&([...V].forEach(({buffer:e,url:i})=>{h(i,e,!0),w((0,t.dirname)(i),(0,t.basename)(i))}),g([]))},[w,V,h]),(0,r.useEffect)(()=>(j.current||(j.current=!0,x()),()=>{var e,i,n,l,t,r;!j&&(null===(n=window.VimWrapperModule)||void 0===n?void 0:null===(i=n.VimModule)||void 0===i?void 0:null===(e=i.asmLibraryArg)||void 0===e?void 0:e._vimjs_prepare_exit())&&(null===(r=window.VimWrapperModule)||void 0===r||null===(t=r.VimModule)||void 0===t||null===(l=t.exit)||void 0===l||l.call(t))}),[x]),(0,l.jsxs)(a,{children:[(0,l.jsx)("div",{id:"vimjs-container",...(0,u.Z)({id:e}),children:(0,l.jsx)("canvas",{id:"vimjs-canvas",onContextMenuCapture:m.nK})}),(0,l.jsx)("div",{id:"vimjs-font-test"})]})}},81338:function(e,i,n){var l=n(67294),t=n(59140);i.Z=()=>{let{mountEmscriptenFs:e,unMapFs:i,updateFolder:n}=(0,t.o)(),r=(0,l.useRef)();return(0,l.useEffect)(()=>()=>{if(r.current){let e=r.current;r.current="";try{i(e,!0).then(()=>n("/",void 0,e))}catch{}}},[i,n]),(0,l.useCallback)(async(i,l)=>{if(!i)return;let t="";try{t=await e(i,l)}catch{}t&&(n("/",t),r.current=t)},[e,n])}},54944:function(e,i,n){var l=n(1864),t=n(67294),r=n(46013),a=n(36094),o=n(41893),u=n(59140),s=n(78743),d=n(12691),c=n(26550),v=n(27972);i.Z=({callback:e,directory:i=c.Ll,id:n,onDragLeave:m,onDragOver:f,updatePositions:p})=>{let{url:w}=(0,s.z)(),{iconPositions:h,sortOrders:b,setIconPositions:$}=(0,d.k)(),{mkdirRecursive:y,updateFolder:M,writeFile:V}=(0,u.o)(),g=(0,t.useCallback)(async(e,i,t)=>{if(n){if(i){let r=(0,l.join)(c.Ll,e);if(await y(c.Ll),await V(r,i,!0))return t===o.v.UPDATE_URL&&w(n,r),M(c.Ll,e),(0,l.basename)(r)}else t===o.v.UPDATE_URL&&w(n,e)}return""},[n,y,M,w,V]),{openTransferDialog:j}=(0,r.Z)();return{onDragLeave:m,onDragOver:e=>{null==f||f(e),(0,v.nK)(e)},onDrop:t=>{if(!c.my.has((0,v.RT)(i))){if(p&&t.target instanceof HTMLElement){let{files:e,text:n}=(0,a.p4)(t);if(0===e.length&&""===n)return;let r={x:t.clientX,y:t.clientY},o=[];if(n){try{o=JSON.parse(n)}catch{}if(!Array.isArray(o))return;let[e]=o;if(!e||e.startsWith(i)&&(0,l.basename)(e)===(0,l.relative)(i,e))return;o=o.map(e=>(0,l.basename)(e))}else o=e instanceof FileList?[...e].map(e=>e.name):[...e].map(e=>{var i;return(null===(i=e.getAsFile())||void 0===i?void 0:i.name)||""}).filter(Boolean);o=o.map(e=>{if(!h[`${i}/${e}`])return e;let n=0,t="";do n+=1,t=`${i}/${(0,l.basename)(e,(0,l.extname)(e))} (${n})${(0,l.extname)(e)}`;while(h[t]);return(0,l.basename)(t)}),(0,v.vi)(i,t.target,h,b,r,o,$)}(0,a.WG)(t,e||g,i,j,!!n)}}}}},34772:function(e,i,n){var l=n(67294),t=n(78743),r=n(28272),a=n(26550);i.Z=e=>{let{title:i}=(0,t.z)(),[n]=e.split(a.CC),{title:o}=r.Z[n]||{};return{appendFileToTitle:(0,l.useCallback)((n,l)=>{let t=n?` - ${n}${l?` ${a.xy}`:""}`:"";i(e,`${o}${t}`)},[e,o,i]),prependFileToTitle:(0,l.useCallback)((n,l,t)=>{let r=n?`${l?`${a.xy} `:""}${n}${t?" ":" - "}`:"";i(e,`${r}${o}`)},[e,o,i])}}}}]);