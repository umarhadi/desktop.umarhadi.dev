"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7280],{41311:function(e,t,i){var n=i(11527),o=i(87373),r=i(7372),a=i(38974),s=i.n(a),l=i(50959);const c=s()((()=>i.e(2817).then(i.bind(i,62817))),{loadableGenerated:{webpack:()=>[62817]}}),u=e=>{let{id:t,useHook:i,StyledComponent:a,children:s}=e;const{processes:{[t]:{url:u=""}={}}}=(0,r.z)(),h=(0,l.useRef)(null),[d,f]=(0,l.useState)(!0),p=(0,l.useMemo)((()=>({contain:"strict",visibility:d?"hidden":"visible"})),[d]);return i({containerRef:h,id:t,loading:d,setLoading:f,url:u}),(0,n.jsxs)(n.Fragment,{children:[d&&(0,n.jsx)(c,{}),(0,n.jsx)(a,{ref:h,style:p,...(0,o.Z)({id:t}),children:s})]})};t.Z=(0,l.memo)(u)},67280:function(e,t,i){i.r(t),i.d(t,{default:function(){return k}});var n=i(11527),o=i(41311);var r=i(94386).ZP.div.withConfig({componentId:"sc-ff609c9c-0"})`
  canvas {
    background-color: #000;
    height: auto !important;
    width: auto !important;
  }

  div {
    font-family: "Liberation Mono", "DejaVu Sans Mono", "Courier New", monospace;
    font-size: 14px;
    font-weight: 700;
    line-height: normal;
    position: relative;
    white-space: pre;
  }
`;const a={autostart:!0,bios:{url:"/Program Files/Virtual x86/bios/seabios.bin"},log_level:0,network_relay_url:"wss://relay.widgetry.org/",vga_bios:{url:"/Program Files/Virtual x86/bios/vgabios.bin"},wasm_path:"/Program Files/Virtual x86/v86.wasm"},s=new Set([160,180,200,320,360,400,720,1200,1440,1722,2880]),l=(e,t)=>".bin"===e?"bzimage":(e=>s.has(e>>10)&&0===(1023&e)||512===e)(t)?"fda":"hda";var c=i(76948),u=i(50959);const h="screen-set-size-graphical",d="screen-set-size-text";var f=(e,t,i)=>{const{updateWindowSize:n}=(0,c.Z)(e);(0,u.useEffect)((()=>{const e=e=>{let[t,i]=e;return n(i,t)},o=e=>{let[,i]=e;const{height:o,width:r}=t.current?.querySelector("span:last-of-type")?.getBoundingClientRect()||{};o&&r&&n(i*o,r)};return i?.add_listener(h,e),i?.add_listener(d,o),()=>{i?.remove_listener(h,e),i?.remove_listener(d,o)}}),[i,t,n])},p=i(8437),m=i(46948),g=i(41144),w=i(7372),b=i(87966),x=i(5738),v=i(93203),y=i(70286),T=i(55872).Buffer;window.DEBUG=!1;var _=e=>{let{containerRef:t,id:i,loading:n,setLoading:o,url:r}=e;const{processes:{[i]:s}}=(0,w.z)(),{foregroundId:c}=(0,b.k)(),{closing:h,libs:d=[]}=s||{},{appendFileToTitle:_}=(0,p.Z)(i),k=(0,u.useRef)(!1),[z,C]=(0,u.useState)({}),{exists:$,mkdirRecursive:L,readFile:R,updateFolder:S,writeFile:E}=(0,m.o)(),M=(0,u.useCallback)((e=>new Promise(((t,i)=>{z[e]?.save_state().then(t).catch(i)}))),[z]),F=(0,u.useCallback)((async(e,t)=>{const i=`${(0,x.basename)(e)}.bin.save`;await $(v.Tl)||(await L(v.Tl),S((0,x.dirname)(v.Tl)));const n=(0,x.join)(v.Tl,i);if(await E(n,T.from(await M(e)),!0)){if(t){const e=(0,x.join)(v.Xo,v.Tl),i=(0,x.join)(v.Xo,`${n}${v.Qy}`);await $(e)||(await L(e),S((0,x.dirname)(v.Tl))),await E(i,t,!0)}try{z[e]?.destroy()}catch{}finally{S(v.Tl,i)}}}),[z,$,L,M,S,E]),j=(0,u.useCallback)((async()=>{const[e]=Object.keys(z);e&&await F(e);const i=r?await R(r):T.from(""),n=(0,y.RT)(r),o=".iso"===n,s=(0,y.YS)(i),c={[o?"cdrom":l(n,i.length)]:{async:!1,size:i.length,url:s,use_parts:!1}},{deviceMemory:u=.25}=navigator,h={boot_order:o?531:561,memory_size:128*u*1024*1024,screen_container:t.current,vga_memory_size:8*u*1024*1024,...c,...a},d=(0,x.join)(v.Tl,`${(0,x.basename)(r)}.bin.save`),f=await $(d)?(0,y.YS)(await R(d)):void 0;f&&(h.initial_state={url:f}),h.filesystem={basefs:URL.createObjectURL(new Blob([JSON.stringify((0,g.uh)())],{type:"application/json"})),baseurl:window.location?.origin??"/"};const p=new window.V86Starter(h);p.add_listener("emulator-loaded",(()=>{k.current?p.destroy():(_((0,x.basename)(r)),(0,y.EK)(s),h.initial_state&&(0,y.EK)(h.initial_state.url),h.filesystem&&(0,y.EK)(h.filesystem.basefs),t.current?.addEventListener("click",p.lock_mouse),C({[r]:p}))}))}),[_,F,t,z,$,R,r]);f(i,t,z[r]),(0,u.useEffect)((()=>{n&&(0,y.mb)(d).then((()=>{window.V86Starter&&o(!1)}))}),[d,n,o]),(0,u.useEffect)((()=>{const e=c===i;Object.values(z).forEach((t=>t?.keyboard_set_status(e)))}),[z,c,i]),(0,u.useEffect)((()=>{!s||h||n||r in z||(C({[r]:void 0}),j());const e=t.current;return()=>{if(r&&h&&!k.current&&(k.current=!0,z[r])){const t=e=>{window.setTimeout((()=>F(r,e)),v.jx.WINDOW)};(async()=>{let t;if(z[r]?.v86.cpu.devices.vga.graphical_mode)t=e?.querySelector("canvas")?.toDataURL("image/png");else if(e instanceof HTMLElement){const i=await(0,y.mZ)();try{t=await(i?.toPng(e,{skipAutoScale:!0}))}catch{}}return t?T.from(t.replace("data:image/png;base64,",""),"base64"):void 0})().then(t).catch(t)}}}),[F,h,t,z,j,n,s,r])};var k=e=>{let{id:t}=e;return(0,n.jsxs)(o.Z,{StyledComponent:r,id:t,useHook:_,children:[(0,n.jsx)("div",{onContextMenuCapture:y.nK}),(0,n.jsx)("canvas",{onContextMenuCapture:y.nK})]})}},87373:function(e,t,i){var n=i(54660),o=i(39397),r=i(22449),a=i(46948),s=i(7372),l=i(87966),c=i(5738),u=i(50959),h=i(93203),d=i(70286);t.Z=e=>{let{callback:t,directory:i=h.Ll,id:f,onDragLeave:p,onDragOver:m,updatePositions:g}=e;const{url:w}=(0,s.z)(),{iconPositions:b,sortOrders:x,setIconPositions:v}=(0,l.k)(),{mkdirRecursive:y,updateFolder:T,writeFile:_}=(0,a.o)(),k=(0,u.useCallback)((async(e,t,i)=>{if(f)if(t){const n=(0,c.join)(h.Ll,e);await y(h.Ll),await _(n,t,!0)&&(i===r.v.UPDATE_URL&&w(f,n),T(h.Ll,e))}else i===r.v.UPDATE_URL&&w(f,e)}),[f,y,T,w,_]),{openTransferDialog:z}=(0,n.Z)();return{onDragLeave:p,onDragOver:e=>{m?.(e),(0,d.nK)(e)},onDrop:e=>{if(!h.my.has((0,d.RT)(i))){if(g&&e.target instanceof HTMLElement){const{files:t,text:n}=(0,o.p4)(e);if(0===t.length&&""===n)return;const r={x:e.clientX,y:e.clientY};let a=[];if(n){try{a=JSON.parse(n)}catch{}if(!Array.isArray(a))return;const[e]=a;if(!e)return;if(e.startsWith(i)&&(0,c.basename)(e)===(0,c.relative)(i,e))return;a=a.map((e=>(0,c.basename)(e)))}else a=t instanceof FileList?[...t].map((e=>e.name)):[...t].map((e=>e.getAsFile()?.name||"")).filter(Boolean);a=a.map((e=>{if(!b[`${i}/${e}`])return e;let t=0,n="";do{t+=1,n=`${i}/${(0,c.basename)(e,(0,c.extname)(e))} (${t})${(0,c.extname)(e)}`}while(b[n]);return(0,c.basename)(n)})),(0,d.vi)(i,e.target,b,x,r,a,v)}(0,o.WG)(e,t||k,i,z,Boolean(f))}}}}},97183:function(e,t,i){i.d(t,{BS:function(){return a},FC:function(){return o},F_:function(){return n},wV:function(){return r}});const n={bottom:!1,bottomLeft:!1,bottomRight:!1,left:!1,right:!1,top:!1,topLeft:!1,topRight:!1},o={bottom:!0,bottomLeft:!0,bottomRight:!0,left:!0,right:!0,top:!0,topLeft:!0,topRight:!0},r=30,a=166,s={cancel:".cancel",dragHandleClassName:"handle",enableUserSelectHack:!1,minHeight:`${r}px`,minWidth:`${a}px`,resizeHandleStyles:{bottom:{bottom:"-3px",cursor:"ns-resize",height:"6px"},bottomLeft:{bottom:"-3px",cursor:"nesw-resize",height:"12px",left:"-3px",width:"12px"},bottomRight:{bottom:"-3px",cursor:"nwse-resize",height:"12px",right:"-3px",width:"12px"},left:{cursor:"ew-resize",left:"-3px",width:"6px"},right:{cursor:"ew-resize",right:"-3px",width:"6px"},top:{cursor:"ns-resize",height:"6px",top:"-3px"},topLeft:{cursor:"nwse-resize",height:"12px",left:"-3px",top:"-3px",width:"12px"},topRight:{cursor:"nesw-resize",height:"12px",right:"-3px",top:"-3px",width:"12px"}}};t.ZP=s},13690:function(e,t,i){i.d(t,{Rf:function(){return s},b$:function(){return u},hu:function(){return a},ix:function(){return c},mZ:function(){return l}});var n=i(97183),o=i(93203),r=i(70286);const a=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const[a]=e.split(o.CC),s=`${a}${o.CC}`,l=i.find((e=>e.startsWith(s)))||"",{componentWindow:c}=t?.[l]||{},{x:u=0,y:h=0,width:d=0,height:f=0}=c?.getBoundingClientRect()||{},p=u+n+d>(0,r.E9)()||h+n+f>(0,r.sI)();return p||!u&&!h?void 0:{x:u+n,y:h+n}},s=e=>{let{height:t,width:i}=e;const[n,a]=[(0,r.sI)(),(0,r.E9)()];return{x:Math.floor(a/2-(0,r.Vy)(i)/2),y:Math.floor((n-o.bK)/2-(0,r.Vy)(t)/2)}},l={BOTTOM:15,LEFT:150,RIGHT:50,TOP:15},c=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{position:n,size:o}=e||{},{x:a=0,y:s=0}=n||{},{height:c=0,width:u=0}=o||{};return i?a+l.RIGHT>t.x||a+(0,r.Vy)(u)-l.LEFT<0||s+l.BOTTOM>t.y||s+l.TOP<0:a<0||s<0||a+(0,r.Vy)(u)>t.x||s+(0,r.Vy)(c)>t.y},u=(e,t)=>{const i=Number(e.height),a=Number(e.width),[s,l]=[(0,r.sI)(),(0,r.E9)()],c=s-o.bK,u=Math.max(n.wV,Math.min(i,c)),h=Math.max(n.BS,Math.min(a,l));if(!t)return{height:u,width:h};const d=i===u,f=a===h;return d||f?d?f?{height:u,width:h}:{height:Math.round(u/(a/h)),width:h}:{height:u,width:Math.round(h/(i/u))}:i>a?{height:u,width:Math.round(h/(c/u))}:{height:Math.round(u/(l/h)),width:h}}},8437:function(e,t,i){var n=i(7372),o=i(50106),r=i(50959),a=i(93203);t.Z=e=>{const{title:t}=(0,n.z)(),[i]=e.split(a.CC),{title:s}=o.Z[i]||{};return{appendFileToTitle:(0,r.useCallback)(((i,n)=>{const o=i?` - ${i}${n?` ${a.xy}`:""}`:"";t(e,`${s}${o}`)}),[e,s,t]),prependFileToTitle:(0,r.useCallback)(((i,n,o)=>{const r=i?`${n?`${a.xy} `:""}${i}${o?" ":" - "}`:"";t(e,`${r}${s}`)}),[e,s,t])}}},76948:function(e,t,i){var n=i(13690),o=i(7372),r=i(87966),a=i(50959),s=i(94386);t.Z=e=>{const{setWindowStates:t}=(0,r.k)(),{processes:{[e]:{lockAspectRatio:i=!1,maximized:l=!1}={}}={}}=(0,o.z)(),{sizes:{titleBar:c}}=(0,s.Fg)();return{updateWindowSize:(0,a.useCallback)(((o,r)=>t((t=>({...t,[e]:{...t?.[e],maximized:l,size:(0,n.b$)({height:o+c.height,width:r},i)}})))),[e,i,l,t,c.height])}}}}]);