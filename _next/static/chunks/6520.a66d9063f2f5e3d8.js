"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6520,5598],{70023:function(e,t,n){var i=n(11527),r=n(9297),a=n(32652),o=n(30952),s=n.n(o),c=n(50959);const l=s()((()=>n.e(4158).then(n.bind(n,24158))),{loadableGenerated:{webpack:()=>[24158]}}),u=e=>{let{id:t,useHook:n,StyledComponent:o,children:s}=e;const{processes:{[t]:{url:u=""}={}}}=(0,a.z)(),d=(0,c.useRef)(null),[f,m]=(0,c.useState)(!0),w=(0,c.useMemo)((()=>({contain:"strict",visibility:f?"hidden":"visible"})),[f]);return n({containerRef:d,id:t,loading:f,setLoading:m,url:u}),(0,i.jsxs)(i.Fragment,{children:[f&&(0,i.jsx)(l,{}),(0,i.jsx)(o,{ref:d,style:w,...(0,r.Z)({id:t}),children:s})]})};t.Z=(0,c.memo)(u)},16520:function(e,t,n){n.r(t),n.d(t,{default:function(){return h}});var i=n(11527),r=n(70023);var a=n(6444).ZP.div.withConfig({componentId:"sc-1d70034d-0"})`
  &.drop {
    &::before {
      color: #f1f1f1;
      content: "Drop rom file here";
      display: flex;
      font-size: 16px;
      font-weight: 600;
      height: 100%;
      left: 0;
      place-content: center;
      place-items: center;
      position: absolute;
      top: 0;
      width: 100%;
    }
  }
`,o=n(72497),s=n(7217),c=n(31266),l=n(32652),u=n(735),d=n(50959),f=n(71059),m=n(46429),w=n(85598),p=n(55872).Buffer;var S=e=>{let{containerRef:t,id:n,loading:i,setLoading:r,url:a}=e;const{exists:S,mkdirRecursive:h,readFile:v,updateFolder:b,writeFile:E}=(0,c.o)(),{linkElement:g,processes:{[n]:{closing:y=!1}={}}={}}=(0,l.z)(),{prependFileToTitle:F}=(0,s.Z)(n),k=(0,d.useRef)(),T=(0,d.useRef)(""),$=(0,d.useCallback)((async()=>{if(!a)return;if(t.current?.classList.remove("drop"),T.current){if(T.current!==a&&(T.current="",window.EJS_terminate?.(),t.current)){const e=document.createElement("div");e.id="emulator",[...t.current.children].forEach((e=>e.remove())),t.current.append(e),$()}return}T.current=a,window.EJS_gameName=(0,u.basename)(a,(0,u.extname)(a));const[e,{core:n="",zip:i=!1}={}]=(s=(0,m.RT)(a),Object.entries(o.P).find((e=>{let[,{ext:t}]=e;return t.includes(s)}))||[]);var s;const c=await v(a);window.EJS_gameUrl=(0,m.YS)(i?p.from(await(0,w.zipAsync)({[(0,u.basename)(a)]:c})):c),window.EJS_core=n;const l=`${(0,u.basename)(a)}.sav`,d=(0,u.join)(f.Tl,l);window.EJS_onGameStart=e=>{let{detail:{emulator:t}}=e;(async()=>{await S(d)&&t.loadState?.(await v(d)),r(!1),k.current=t})()},window.EJS_onSaveState=e=>{let{screenshot:t,state:n}=e;window.EJS_terminate?.();n&&(async()=>{if(await S(f.Tl)||await h(f.Tl),await E(d,p.from(n),!0)){const e=(0,u.join)(f.Xo,f.Tl),n=(0,u.join)(f.Xo,`${d}${f.Qy}`);await S(e)||(await h(e),b((0,u.dirname)(f.Tl))),await E(n,p.from(t),!0),b(f.Tl,l)}})()},window.EJS_player="#emulator",window.EJS_biosUrl="",window.EJS_pathtodata="Program Files/EmulatorJs/",window.EJS_startOnLoaded=!0,window.EJS_RESET_VARS=!0,window.EJS_Buttons={cacheManage:!1,loadState:!1,quickLoad:!1,quickSave:!1,saveState:!1,screenRecord:!1,screenshot:!1},await(0,m.mb)(["/Program Files/EmulatorJs/loader.js"],void 0,!0),F(`${window.EJS_gameName} (${e})`)}),[t,S,h,F,v,r,b,a,E]);(0,d.useEffect)((()=>{a?$():(r(!1),t.current?.classList.add("drop"))}),[t,$,r,a]),(0,d.useEffect)((()=>{if(!i){const e=t.current?.querySelector("canvas");e instanceof HTMLCanvasElement&&g(n,"peekElement",e)}return()=>{!i&&y&&k.current?.elements.buttons.saveState?.click()}}),[y,t,n,g,i])};var h=e=>{let{id:t}=e;return(0,i.jsx)(r.Z,{StyledComponent:a,id:t,useHook:S,children:(0,i.jsx)("div",{id:"emulator"})})}},9297:function(e,t,n){var i=n(32026),r=n(62358),a=n(34917),o=n(31266),s=n(32652),c=n(64037),l=n(735),u=n(50959),d=n(71059),f=n(46429);t.Z=e=>{let{callback:t,directory:n=d.Ll,id:m,onDragLeave:w,onDragOver:p,updatePositions:S}=e;const{url:h}=(0,s.z)(),{iconPositions:v,sortOrders:b,setIconPositions:E}=(0,c.k)(),{mkdirRecursive:g,updateFolder:y,writeFile:F}=(0,o.o)(),k=(0,u.useCallback)((async(e,t,n)=>{if(m)if(t){const i=(0,l.join)(d.Ll,e);await g(d.Ll),await F(i,t,!0)&&(n===a.v.UPDATE_URL&&h(m,i),y(d.Ll,e))}else n===a.v.UPDATE_URL&&h(m,e)}),[m,g,y,h,F]),{openTransferDialog:T}=(0,i.Z)();return{onDragLeave:w,onDragOver:e=>{p?.(e),(0,f.nK)(e)},onDrop:e=>{if(!d.my.has((0,f.RT)(n))){if(S&&e.target instanceof HTMLElement){const{files:t,text:i}=(0,r.p4)(e);if(0===t.length&&""===i)return;const a={x:e.clientX,y:e.clientY};let o=[];if(i){try{o=JSON.parse(i)}catch{}if(!Array.isArray(o))return;const[e]=o;if(!e)return;if(e.startsWith(n)&&(0,l.basename)(e)===(0,l.relative)(n,e))return;o=o.map((e=>(0,l.basename)(e)))}else o=t instanceof FileList?[...t].map((e=>e.name)):[...t].map((e=>e.getAsFile()?.name||"")).filter(Boolean);o=o.map((e=>{if(!v[`${n}/${e}`])return e;let t=0,i="";do{t+=1,i=`${n}/${(0,l.basename)(e,(0,l.extname)(e))} (${t})${(0,l.extname)(e)}`}while(v[i]);return(0,l.basename)(i)})),(0,f.vi)(n,e.target,v,b,a,o,E)}(0,r.WG)(e,t||k,n,T,Boolean(m))}}}}},7217:function(e,t,n){var i=n(32652),r=n(81030),a=n(50959),o=n(71059);t.Z=e=>{const{title:t}=(0,i.z)(),[n]=e.split(o.CC),{title:s}=r.Z[n]||{};return{appendFileToTitle:(0,a.useCallback)(((n,i)=>{const r=n?` - ${n}${i?` ${o.xy}`:""}`:"";t(e,`${s}${r}`)}),[e,s,t]),prependFileToTitle:(0,a.useCallback)(((n,i,r)=>{const a=n?`${i?`${o.xy} `:""}${n}${r?" ":" - "}`:"";t(e,`${a}${s}`)}),[e,s,t])}}},85598:function(e,t,n){n.d(t,{addEntryToZippable:function(){return c},addFileToZip:function(){return d},createZippable:function(){return s},isFileInZip:function(){return f},unarchive:function(){return m},unzip:function(){return l},zipAsync:function(){return u}});var i=n(735),r=n(71059),a=n(46429),o=n(55872).Buffer;const s=(e,t)=>e.split("/").reduceRight(((e,t)=>({[t]:e})),[t,r.BF]),c=(e,t)=>{const[[n,i]]=Object.entries(t);return e[n]=n in e?c(e[n],t[n]):i,e},l=e=>new Promise(((t,i)=>{n.e(5017).then(n.bind(n,75017)).then((n=>{let{unzip:r}=n;return r(e,((e,n)=>e?i(e):t(n)))}))})),u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.BF;return new Promise(((i,r)=>{n.e(5017).then(n.bind(n,75017)).then((n=>{let{zip:a}=n;return a(e,t,((e,t)=>e?r(e):i(t)))}))}))},d=async(e,t,n,i)=>o.from(await u(c(e.length>0&&await l(e)||{},s(n,await i(t))))),f=(e,t)=>new Promise(((i,r)=>{n.e(5017).then(n.bind(n,75017)).then((n=>{let{unzip:a}=n;return a(e,((e,n)=>e?r(e):i(Object.keys(n).includes(t))))}))})),m=async(e,t)=>{if(window.SevenZip||await(0,a.mb)(["System/7zip/7zz.es6.js"]),!window.SevenZip)return{};const n=await window.SevenZip(),r=(0,i.basename)(e),s=(0,i.join)("/",(0,i.basename)(e,(0,i.extname)(e)));n.FS.mkdir(s),n.FS.chdir(s);const c=n.FS.open(r,"w+");n.FS.write(c,t,0,t.length),n.FS.close(c),n.callMain(["-y","x",r]);const l=n.FS.readdir(s),u=e=>(t,a)=>{if([".","..",r].includes(a))return t;const c=(0,i.join)(e,a),l=c.replace(s,"");try{n.FS.chmod(c,511)}catch{}return Object.assign(t,n.FS.isDir(n.FS.stat(c).mode)?{[(0,i.join)(l,"/")]:o.from(""),...n.FS.readdir(c).reduce(u(c),{})}:{[l]:n.FS.readFile(c,{flags:"r"})}),t};return l.reduce(u(s),{})}}}]);