"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1621,4730],{24730:function(t,e,n){n.r(e),n.d(e,{BASE_WEBAMP_OPTIONS:function(){return c},MAIN_WINDOW:function(){return d},PLAYLIST_WINDOW:function(){return p},cleanBufferOnSkinLoad:function(){return h},closeEqualizer:function(){return m},createM3uPlaylist:function(){return W},enabledMilkdrop:function(){return f},focusWindow:function(){return x},getMetadataProvider:function(){return D},getWebampElement:function(){return E},loadButterchurnPreset:function(){return y},loadMilkdropWhenNeeded:function(){return S},parseTrack:function(){return v},setSkinData:function(){return w},tracksFromPlaylist:function(){return I},unFocus:function(){return T},updateWebampPosition:function(){return k}});var i=n(44586),r=n(44558),a=n(46428);const o=new Set(["Flexi - alien fish pond","Geiss - Spiral Artifact"]),s=`${r.Sd}/Documents/Winamp Skins`,l=["localhost",r.Ou.author.url.replace("https://","")].includes(window.location.hostname),c={availableSkins:[{name:"Aqua X",url:`${s}/Aqua_X.wsz`},{name:"Nucleo NLog v2G",url:`${s}/Nucleo_NLog_v102.wsz`},...l?[{defaultName:"Random (Winamp Skin Museum)",loading:!1,get name(){return this.loading||(this.loading=!0,fetch("https://api.webamp.org/graphql",{body:JSON.stringify({query:(t=Math.floor(1e3*Math.random()),`\n  query {\n    skins(filter: APPROVED, first: 1, offset: ${t}) {\n      nodes {\n        download_url\n      }\n    }\n  }\n`)}),headers:{"Content-Type":"application/json"},method:"POST"}).then((async t=>{const{data:e}=await t.json()||{};this.skinUrl=e?.skins?.nodes?.[0]?.download_url,this.loading=!1}))),this.defaultName;var t},skinUrl:"",get url(){return this.skinUrl||`${s}/base-2.91.wsz`}}]:[],{name:"SpyAMP Professional Edition v5",url:`${s}/SpyAMP_Professional_Edition_v5.wsz`}]},u={height:116,width:275},d="#main-window",p="#playlist-window",h=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.skinIsLoaded().then((()=>{e&&(0,a.EK)(e)}))},m=t=>t.store.dispatch({type:"CLOSE_WINDOW",windowId:"equalizer"}),f=t=>t.store.dispatch({open:!1,type:"ENABLE_MILKDROP"}),w=(t,e)=>t.store.dispatch({data:e,type:"SET_SKIN_DATA"}),g=t=>{const{presetHistory:e=[],presets:n=[]}=t.store.getState()?.milkdrop||{},i=Math.floor(Math.random()*n.length),r=n[i];return!r.name||o.has(r.name)||e.slice(-5).includes(i)?g(t):i},y=t=>{const e=g(t);t.store.dispatch({addToHistory:!0,index:e,type:"PRESET_REQUESTED"}),t.store.dispatch({index:e,type:"SELECT_PRESET_AT_INDEX"})};let b=0;const S=t=>{const e=t.store.subscribe((()=>{const{milkdrop:i,windows:r}=t.store.getState();r?.genWindows?.milkdrop?.open&&!i?.butterchurn&&(0,a.mb)(["/Program Files/Webamp/butterchurn.min.js"]).then((()=>{if(!window.butterchurn?.default)return;((t,e)=>{t.store.dispatch({butterchurn:e,type:"GOT_BUTTERCHURN"})})(t,window.butterchurn.default);const{playlist:i,main:a}=r.genWindows||{},{x:o=0,y:s=0}=(i?.open?i?.position:a?.position)||{};t.store.dispatch({positions:{milkdrop:{x:o,y:s+u.height}},type:"UPDATE_WINDOW_POSITIONS"}),e(),t.store.subscribe((()=>{const t=[...document.body.children].find((t=>t.classList?.contains("webamp-desktop")));if(t){const e=document.querySelector("main");e&&([...e.children].forEach((t=>{t.classList?.contains("webamp-desktop")&&t.remove()})),e.append(t))}})),n.e(4519).then(n.t.bind(n,49589,23)).then((e=>{let{default:n}=e;const i=Object.entries(n).map((t=>{let[e,n]=t;return{name:e,preset:n}}));((t,e)=>{t.store.dispatch({presets:e,type:"GOT_BUTTERCHURN_PRESETS"})})(t,i),y(t),(t=>{window.clearInterval(b),b=window.setInterval((()=>{t||window.clearInterval(b),y(t)}),2e4)})(t)}))}))}))},E=()=>document.querySelector("#webamp"),k=(t,e)=>{const{height:n,width:r}=u,{x:a,y:o}=e||(0,i.Rf)({height:2*n,width:r});t.store.dispatch({positions:{main:{x:a,y:o},milkdrop:{x:0-r,y:0-n},playlist:{x:a,y:n+o}},type:"UPDATE_WINDOW_POSITIONS"})},x=(t,e)=>t.store.dispatch({type:"SET_FOCUSED_WINDOW",window:e}),T=t=>t.store.dispatch({type:"SET_FOCUSED_WINDOW",window:""}),v=async(t,e)=>{const{parseBuffer:i}=await Promise.all([n.e(5181),n.e(7181),n.e(9016)]).then(n.bind(n,37181)),{common:{album:o="",artist:s="",title:l=e},format:{duration:c=0}}=await i(t,{mimeType:r.BD,size:t.length},{duration:!0,skipCovers:!0,skipPostHeaders:!0});return{blob:(0,a.V4)(t,"audio/mpeg"),duration:Math.floor(c),metaData:{album:o,artist:s,title:l}}},W=t=>`${["#EXTM3U",...t.map((t=>{const e=t.url?`\n${t.url.toString()}`:"";let n=t.defaultName;return t.metaData?.artist?t.metaData?.title?n=`${t.metaData.artist} - ${t.metaData.title}`:n&&(n=`${t.metaData.artist} - ${n}`):t.metaData?.title&&(n=t.metaData.title),e?`#EXTINF:${t.duration??-1},${n||""}${e}`:""})).filter(Boolean)].join("\n")}\n`,I=async(t,e,i)=>{const{ASX:r,M3U:a,PLS:o}=await n.e(9099).then(n.t.bind(n,59099,23));return({".asx":r,".m3u":a,".pls":o}[e]?.parse(t).filter(Boolean).slice(0,1e3)??[]).map((t=>{let{artist:e="",file:n="",length:r=0,title:a=""}=t;const[o,s]=[e.trim(),a.trim()];return{duration:r>0?r:0,metaData:{album:s||i,artist:o,title:s},url:n}}))},O=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.replace(/<!\[CDATA\[|]]>/g,"")},L={"somafm.com":t=>async()=>{const{pathname:e}=new URL(t),[n]=e.replace("/","").split("-"),i=await(await fetch(`https://somafm.com/songs/${n}.xml`,{cache:"no-cache",credentials:"omit",keepalive:!1,mode:"cors",referrerPolicy:"no-referrer",window:null})).text(),r=(new DOMParser).parseFromString(i,"application/xml").querySelector("song"),a=r?.querySelector("artist")?.innerHTML,o=r?.querySelector("title")?.innerHTML;return{artist:O(a),title:O(o)}}},D=t=>{const{host:e}=new URL(t),[,n,i]=e.split(".");return L[`${n}.${i}`]?.(t)}},91621:function(t,e,n){n.r(e),n.d(e,{default:function(){return k}});var i=n(11527),r=n(24730),a=n(40830);var o=(0,n(79416).ZP)(a.m.div).withConfig({componentId:"sc-b3cd09d-0"})`
  inset: 0;
  pointer-events: none;
  position: absolute;
  z-index: ${t=>{let{$zIndex:e}=t;return e}};

  div:first-child {
    pointer-events: ${t=>{let{$minimized:e}=t;return e?"none":"auto"}};
  }
`,s=n(99709),l=n(56012),c=n(14762),u=n(97057),d=n(67122),p=n(6733),h=n(11523),m=n(50959),f=n(44558),w=n(46428),g=n(55872).Buffer;const y=`${f.Tl}/webampSkinData.json`;var b=t=>{const{onClose:e,onMinimize:n}=(0,l.Z)(t),{setWindowStates:i,windowStates:{[t]:a}={}}=(0,p.k)(),{position:o}=a||{},{linkElement:b,processes:{[t]:S},title:E}=(0,u.z)(),{closing:k,componentWindow:x}=S||{},T=(0,m.useRef)(),{createPath:v,deletePath:W,exists:I,readFile:O,mkdirRecursive:L,updateFolder:D,writeFile:_}=(0,c.o)(),{onDrop:P}=(0,s.Z)({id:t}),z=(0,m.useRef)(),M=(0,m.useRef)(),N=(0,m.useRef)([]),C=(0,m.useCallback)((t=>{t?.(),e(),window.setTimeout((()=>{N.current.forEach((t=>t())),T.current?.close()}),f.jx.WINDOW),window.clearInterval(z.current),window.clearInterval(M.current)}),[e]),R=(0,m.useCallback)(((e,a)=>{let{initialSkin:s,initialTracks:l}=a;const c=async()=>{const t=prompt("Enter an Internet location to open here:\nFor example: https://server.com/playlist.m3u");if(t){const e=(0,w.RT)(t);return f.uH.has(e)?(0,r.tracksFromPlaylist)(await(await fetch(t,f.P8)).text(),e):[{duration:0,url:t}]}return[]},u=new window.Webamp({...r.BASE_WEBAMP_OPTIONS,handleAddUrlEvent:c,handleLoadListEvent:c,handleSaveListEvent:t=>{v("playlist.m3u",f.Ll,g.from((0,r.createM3uPlaylist)(t))).then((t=>D(f.Ll,t)))},initialSkin:s,initialTracks:l});N.current.push(u.onWillClose(C),u.onMinimize((()=>n())),u.onTrackDidChange((e=>{const{milkdrop:n,windows:i}=u.store.getState();if(i?.genWindows?.milkdrop?.open&&n?.butterchurn&&(0,r.loadButterchurnPreset)(u),window.clearInterval(z.current),e?.url){const n=(0,r.getMetadataProvider)(e.url);if(n){const e=async()=>{const{display:{closed:e=!1}={},playlist:{currentTrack:i=-1}={},tracks:r}=u.store.getState()||{};if(e)window.clearInterval(z.current);else if(r[i]){const e=await(n?.());e&&(u.store.dispatch({type:"SET_MEDIA_TAGS",...r[i],...e}),E(t,`${e.artist} - ${e.title}`))}};e(),z.current=window.setInterval(e,30*f.i2)}else{const{playlist:{currentTrack:e=-1}={},tracks:n}=u.store.getState()||{};if(n[e]){const{artist:i,title:r}=n[e];let a="";r&&i?a=`${i} - ${r}`:(r||i)&&(a=r||i),a&&E(t,a)}}}else E(t,d.Z.Webamp.title)})),u._actionEmitter.on("SET_SKIN_DATA",(async t=>{let{data:e}=t;await I(f.Tl)||(await L(f.Tl),D((0,h.dirname)(f.Tl))),_(y,JSON.stringify(e),!0),D(f.Tl,(0,h.basename)(y))})),u._actionEmitter.on("LOAD_DEFAULT_SKIN",(()=>{W(y)})),u._actionEmitter.on("UPDATE_WINDOW_POSITIONS",(()=>{window.clearInterval(M.current),M.current=window.setTimeout((()=>{const e=(0,r.getWebampElement)()?.querySelector(r.MAIN_WINDOW),{x:n=0,y:a=0}=e?.getBoundingClientRect()||{};i((e=>({...e,[t]:{position:{x:n,y:a}}})))}),f.jx.WINDOW)}))),s&&(0,r.cleanBufferOnSkinLoad)(u,s.url),u.renderWhenReady(e).then((()=>{(0,r.closeEqualizer)(u),(0,r.enabledMilkdrop)(u),(0,r.loadMilkdropWhenNeeded)(u),(0,r.updateWebampPosition)(u,o),(()=>{const n=(0,r.getWebampElement)();if(n){const i=n.querySelector(r.MAIN_WINDOW);[i,n.querySelector(r.PLAYLIST_WINDOW)].forEach((t=>{t?.addEventListener("drop",P),t?.addEventListener("dragover",w.nK)})),S&&!x&&i&&(b(t,"componentWindow",e),b(t,"peekElement",i)),s||S.url?.endsWith(".wsz")||I(y).then((async t=>{t&&(0,r.setSkinData)(u,JSON.parse((await O(y)).toString()))})),e.append(n)}})(),l&&u.play()})),window.WebampGlobal=u,T.current=u}),[x,v,W,I,t,b,L,P,n,C,o,S,O,i,E,D,_]);return(0,m.useEffect)((()=>{k&&C()}),[k,C]),{initWebamp:R,webampCI:T.current}},S=n(47593),E=n(41209);var k=t=>{let{id:e}=t;const n=(0,m.useRef)(null),{readFile:a}=(0,c.o)(),{processes:{[e]:{libs:s=[],minimized:l=!1,url:d=""}={}}={},url:p}=(0,u.z)(),[g,y]=(0,m.useState)(d),{initWebamp:k,webampCI:x}=b(e),T=(0,E.Z)(e,!0),v=(0,m.useMemo)((()=>({onBlurCapture:()=>x&&(0,r.unFocus)(x),onFocusCapture:()=>x&&(0,r.focusWindow)(x,"main")})),[x]),{zIndex:W,...I}=(0,S.Z)(e,v),O=(0,m.useCallback)((async()=>{if(d){const t=(0,w.RT)(d);if(f.uH.has(t)){const e=await(0,r.tracksFromPlaylist)((await a(d)).toString(),t,(0,h.basename)(d,(0,h.extname)(d)));return e.length>0?{initialTracks:e}:{}}if(".mp3"===t)return{initialTracks:[await(0,r.parseTrack)(await a(d),(0,h.basename)(d))]};if(".wsz"===t)return{initialSkin:{url:(0,w.YS)(await a(d))}}}return{}}),[a,d]),L=(0,m.useCallback)((async()=>{if(x){const{initialTracks:t,initialSkin:e}=await O();t?x.setTracksToPlay(t):e&&((0,r.cleanBufferOnSkinLoad)(x,e.url),x.setSkinFromUrl(e.url))}}),[O,x]),D=(0,m.useRef)(!1);return(0,m.useEffect)((()=>{n.current&&!x&&(0,w.mb)(s).then((async()=>{window.Webamp&&!D.current&&(D.current=!0,k(n.current,await O()))}))}),[O,k,s,x]),(0,m.useEffect)((()=>{d!==g?(L(),y(d)):d&&(p(e,""),y(""))}),[e,L,g,p,d]),(0,i.jsx)(o,{ref:n,$minimized:l,$zIndex:W,...I,...T})}},99709:function(t,e,n){var i=n(55209),r=n(89826),a=n(93770),o=n(14762),s=n(97057),l=n(6733),c=n(11523),u=n(50959),d=n(44558),p=n(46428);e.Z=t=>{let{callback:e,directory:n=d.Ll,id:h,onDragLeave:m,onDragOver:f,updatePositions:w}=t;const{url:g}=(0,s.z)(),{iconPositions:y,sortOrders:b,setIconPositions:S}=(0,l.k)(),{mkdirRecursive:E,updateFolder:k,writeFile:x}=(0,o.o)(),T=(0,u.useCallback)((async(t,e,n)=>{if(h)if(e){const i=(0,c.join)(d.Ll,t);await E(d.Ll),await x(i,e,!0)&&(n===a.v.UPDATE_URL&&g(h,i),k(d.Ll,t))}else n===a.v.UPDATE_URL&&g(h,t)}),[h,E,k,g,x]),{openTransferDialog:v}=(0,i.Z)();return{onDragLeave:m,onDragOver:t=>{f?.(t),(0,p.nK)(t)},onDrop:t=>{if(w&&t.target instanceof HTMLElement){const{files:e,text:i}=(0,r.p4)(t);if(0===e.length&&""===i)return;const a={x:t.clientX,y:t.clientY};let o=[];if(i){try{o=JSON.parse(i)}catch{}if(!Array.isArray(o))return;const[t]=o;if(!t)return;if(t.startsWith(n)&&(0,c.basename)(t)===(0,c.relative)(n,t))return;o=o.map((t=>(0,c.basename)(t)))}else o=e instanceof FileList?[...e].map((t=>t.name)):[...e].map((t=>t.getAsFile()?.name||"")).filter(Boolean);o=o.map((t=>{if(!y[`${n}/${t}`])return t;let e=0,i="";do{e+=1,i=`${n}/${(0,c.basename)(t,(0,c.extname)(t))} (${e})${(0,c.extname)(t)}`}while(y[i]);return(0,c.basename)(i)})),(0,p.vi)(n,t.target,y,b,a,o,S)}(0,r.WG)(t,e||T,n,v,Boolean(h))}}}},56961:function(t,e,n){n.d(e,{BS:function(){return o},FC:function(){return r},F_:function(){return i},wV:function(){return a}});const i={bottom:!1,bottomLeft:!1,bottomRight:!1,left:!1,right:!1,top:!1,topLeft:!1,topRight:!1},r={bottom:!0,bottomLeft:!0,bottomRight:!0,left:!0,right:!0,top:!0,topLeft:!0,topRight:!0},a=30,o=166,s={cancel:".cancel",dragHandleClassName:"handle",enableUserSelectHack:!1,minHeight:`${a}px`,minWidth:`${o}px`,resizeHandleStyles:{bottom:{bottom:"-3px",cursor:"ns-resize",height:"6px"},bottomLeft:{bottom:"-3px",cursor:"nesw-resize",height:"12px",left:"-3px",width:"12px"},bottomRight:{bottom:"-3px",cursor:"nwse-resize",height:"12px",right:"-3px",width:"12px"},left:{cursor:"ew-resize",left:"-3px",width:"6px"},right:{cursor:"ew-resize",right:"-3px",width:"6px"},top:{cursor:"ns-resize",height:"6px",top:"-3px"},topLeft:{cursor:"nwse-resize",height:"12px",left:"-3px",top:"-3px",width:"12px"},topRight:{cursor:"nesw-resize",height:"12px",right:"-3px",top:"-3px",width:"12px"}}};e.ZP=s},56012:function(t,e,n){var i=n(48251),r=n(97057),a=n(6733),o=n(50959);e.Z=t=>{const e=(0,i.Z)(t),{setForegroundId:n,removeFromStack:s}=(0,a.k)(),{closeWithTransition:l,maximize:c,minimize:u}=(0,r.z)();return{onClose:(0,o.useCallback)((()=>{s(t),l(t),n(e)}),[l,t,e,s,n]),onMaximize:()=>c(t),onMinimize:()=>{u(t),n(e)}}}},44586:function(t,e,n){n.d(e,{Rf:function(){return s},b$:function(){return u},hu:function(){return o},ix:function(){return c},mZ:function(){return l}});var i=n(56961),r=n(44558),a=n(46428);const o=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const[o]=t.split(r.CC),s=`${o}${r.CC}`,l=n.find((t=>t.startsWith(s)))||"",{componentWindow:c}=e?.[l]||{},{x:u=0,y:d=0,width:p=0,height:h=0}=c?.getBoundingClientRect()||{},m=u+i+p>(0,a.E9)()||d+i+h>(0,a.sI)();return m||!u&&!d?void 0:{x:u+i,y:d+i}},s=t=>{let{height:e,width:n}=t;const[i,o]=[(0,a.sI)(),(0,a.E9)()];return{x:Math.floor(o/2-(0,a.Vy)(n)/2),y:Math.floor((i-r.bK)/2-(0,a.Vy)(e)/2)}},l={BOTTOM:15,LEFT:150,RIGHT:50,TOP:15},c=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{position:i,size:r}=t||{},{x:o=0,y:s=0}=i||{},{height:c=0,width:u=0}=r||{};return n?o+l.RIGHT>e.x||o+(0,a.Vy)(u)-l.LEFT<0||s+l.BOTTOM>e.y||s+l.TOP<0:o<0||s<0||o+(0,a.Vy)(u)>e.x||s+(0,a.Vy)(c)>e.y},u=(t,e)=>{const n=Number(t.height),o=Number(t.width),[s,l]=[(0,a.sI)(),(0,a.E9)()],c=s-r.bK,u=Math.max(i.wV,Math.min(n,c)),d=Math.max(i.BS,Math.min(o,l));if(!e)return{height:u,width:d};const p=n===u,h=o===d;return p||h?p?h?{height:u,width:d}:{height:Math.round(u/(o/d)),width:d}:{height:u,width:Math.round(d/(n/u))}:n>o?{height:u,width:Math.round(d/(c/u))}:{height:Math.round(u/(l/d)),width:d}}},47593:function(t,e,n){var i=n(97057),r=n(6733),a=n(50959),o=n(44558);e.Z=(t,e)=>{const{foregroundId:n,prependToStack:s,setForegroundId:l,stackOrder:c=[]}=(0,r.k)(),{processes:{[t]:u}}=(0,i.z)(),{closing:d,componentWindow:p,minimized:h,taskbarEntry:m,url:f}=u||{},w=(0,a.useMemo)((()=>c.length+(h?1:-c.indexOf(t))+1),[t,h,c]),g=(0,a.useCallback)((n=>{const{relatedTarget:i}=n,r=i,a=i===m,s=r&&m?.previousSibling?.contains(r),c=r&&p?.contains(r);l((i=>i!==t||a||c?i:(s?p?.focus(o.eS):e?.onBlurCapture?.(n),s?i:"")))}),[e,p,t,l,m]),y=(0,a.useCallback)((n=>{const{relatedTarget:i}=n||{};p?.contains(document.activeElement)?(s(t),l(t)):i&&document.activeElement!==m||(p?.focus(o.eS),e?.onFocusCapture?.(n))}),[e,p,t,s,l,m]);return(0,a.useLayoutEffect)((()=>{t===n&&y()}),[n,t,y]),(0,a.useLayoutEffect)((()=>{!p||d||h||l(t)}),[d,p,t,h,l,f]),(0,a.useMemo)((()=>({onBlurCapture:g,onClickCapture:y,onFocusCapture:y,zIndex:w,...o.LL})),[y,g,w])}},48251:function(t,e,n){var i=n(97057),r=n(6733);e.Z=t=>{const{stackOrder:e=[]}=(0,r.k)(),{processes:n}=(0,i.z)();return e.find((e=>e!==t&&!n?.[e]?.minimized))||""}},41209:function(t,e,n){var i=n(97057),r=n(50959),a=n(44558),o=n(46428);const s={height:"inherit",opacity:1,scale:1,width:"inherit"},l={opacity:0,scale:.95},c={...l,height:"inherit",width:"inherit"},u={...c,scale:1},d={opacity:1,scale:1},p={opacity:0,scale:.7},h=()=>({height:(0,o.sI)()-a.bK,width:(0,o.E9)()});e.Z=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{processes:{[t]:n}={}}=(0,i.z)(),{closing:o,componentWindow:m,maximized:f,minimized:w,taskbarEntry:g}=n||{},[y,b]=(0,r.useState)(Object.create(null)),[S,E]=(0,r.useState)(Object.create(null));return(0,r.useLayoutEffect)((()=>{if(!m||o)return;const{x:t=0,y:e=0}=m.getBoundingClientRect();b({...d,...h(),x:0-t,y:0-e})}),[o,m,f]),(0,r.useLayoutEffect)((()=>{if(!g||!m||o)return;const{height:t=0,width:e=0,x:n=0,y:i=0}=g.getBoundingClientRect(),{height:r=0,width:a=0,x:s=0,y:l=0}=m.getBoundingClientRect(),c=Math.round(n-s-a/2+e/2),u=Math.round(i-l-r/2+t/2);0===c&&0===u||E({...p,x:c,y:u})}),[o,m,w,g]),(0,r.useEffect)((()=>{const t=()=>{f&&b((t=>({...t,...h()})))};return window.addEventListener("resize",t,{passive:!0}),()=>window.removeEventListener("resize",t)}),[f]),{animate:(w?"minimize":"")||(!o&&f?"maximize":"")||"active",exit:"exit",initial:"initial",transition:{duration:a.Nb.WINDOW},variants:{active:s,exit:l,initial:e?u:c,maximize:y,minimize:S}}}}}]);