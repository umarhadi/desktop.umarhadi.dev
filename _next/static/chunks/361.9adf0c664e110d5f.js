"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[361],{30361:function(e,t,n){n.r(t),n.d(t,{default:function(){return h}});var i=n(85893),r=n(964);let a=r.ZP.div.withConfig({componentId:"sc-21247cad-0"})(["display:flex;place-content:center;canvas{background-color:#000;height:100%;width:100%;}"]);var o=n(67294),l=n(81338),s=n(78743),c=n(12691),u=n(26550),d=n(27972),f=({containerRef:e,id:t,setLoading:n,loading:i})=>{let{processes:{[t]:a}={}}=(0,s.z)(),{componentWindow:f,defaultSize:w={height:0,width:0},libs:h=[],maximized:v=!1}=a||{},{windowStates:{[t]:m}}=(0,c.k)(),{sizes:{titleBar:y}}=(0,r.Fg)(),b=(0,o.useRef)(!1),p=(0,l.Z)(),{size:g}=m||{};(0,o.useEffect)(()=>{i&&(0,d.mb)(h).then(()=>{window.ioq3&&(window.ioq3.viewport=e.current,window.ioq3.elementPointerLock=!0,window.ioq3.callMain([]),n(!1),p(window.FS,"Quake3"))})},[e,h,i,p,n]),(0,o.useEffect)(()=>{window.ioq3&&setTimeout(()=>{var e;b.current=v;let{height:t,width:n}=!v&&g||(null==f?void 0:f.getBoundingClientRect())||{};if(!t||!n)return;let i=w?(0,d.Vy)(w.width)/(0,d.Vy)(w.height):4/3,r=(0,d.Vy)(n),a=r>(0,d.Vy)(t)-y.height,o=v&&a?r/i:r,l=o/i;l>0&&o>0&&(null===(e=window.ioq3)||void 0===e?void 0:e.canvas)&&(window.ioq3.setCanvasSize(o,l),window.ioq3.canvas.setAttribute("style",`object-fit: ${a?"contain":"scale-down"}`))},v||b.current?u.jx.WINDOW+10:0)},[f,w,v,g,y.height]),(0,o.useEffect)(()=>()=>{var e,t;try{null===(t=window.ioq3)||void 0===t||t.exit()}catch{}null===(e=window.AL)||void 0===e||e.contexts.forEach(({ctx:e})=>e.close())},[])},w=n(50834),h=({id:e})=>(0,i.jsx)(w.Z,{StyledComponent:a,id:e,useHook:f})},50834:function(e,t,n){var i=n(85893),r=n(5152),a=n.n(r),o=n(67294),l=n(54944),s=n(78743);let c=a()(()=>n.e(446).then(n.bind(n,60446)),{loadableGenerated:{webpack:()=>[60446]}});t.Z=(0,o.memo)(({id:e,useHook:t,StyledComponent:n,children:r})=>{let{processes:{[e]:{url:a=""}={}}}=(0,s.z)(),u=(0,o.useRef)(null),[d,f]=(0,o.useState)(!0),w=(0,o.useMemo)(()=>({contain:"strict",visibility:d?"hidden":"visible"}),[d]);return t({containerRef:u,id:e,loading:d,setLoading:f,url:a}),(0,i.jsxs)(i.Fragment,{children:[d&&(0,i.jsx)(c,{}),(0,i.jsx)(n,{ref:u,style:w,...(0,l.Z)({id:e}),children:r})]})})},81338:function(e,t,n){var i=n(67294),r=n(59140);t.Z=()=>{let{mountEmscriptenFs:e,unMapFs:t,updateFolder:n}=(0,r.o)(),a=(0,i.useRef)();return(0,i.useEffect)(()=>()=>{if(a.current){let e=a.current;a.current="";try{t(e,!0).then(()=>n("/",void 0,e))}catch{}}},[t,n]),(0,i.useCallback)(async(t,i)=>{if(!t)return;let r="";try{r=await e(t,i)}catch{}r&&(n("/",r),a.current=r)},[e,n])}},54944:function(e,t,n){var i=n(1864),r=n(67294),a=n(46013),o=n(36094),l=n(41893),s=n(59140),c=n(78743),u=n(12691),d=n(26550),f=n(27972);t.Z=({callback:e,directory:t=d.Ll,id:n,onDragLeave:w,onDragOver:h,updatePositions:v})=>{let{url:m}=(0,c.z)(),{iconPositions:y,sortOrders:b,setIconPositions:p}=(0,u.k)(),{mkdirRecursive:g,updateFolder:k,writeFile:x}=(0,s.o)(),E=(0,r.useCallback)(async(e,t,r)=>{if(n){if(t){let a=(0,i.join)(d.Ll,e);if(await g(d.Ll),await x(a,t,!0))return r===l.v.UPDATE_URL&&m(n,a),k(d.Ll,e),(0,i.basename)(a)}else r===l.v.UPDATE_URL&&m(n,e)}return""},[n,g,k,m,x]),{openTransferDialog:L}=(0,a.Z)();return{onDragLeave:w,onDragOver:e=>{null==h||h(e),(0,f.nK)(e)},onDrop:r=>{if(!d.my.has((0,f.RT)(t))){if(v&&r.target instanceof HTMLElement){let{files:e,text:n}=(0,o.p4)(r);if(0===e.length&&""===n)return;let a={x:r.clientX,y:r.clientY},l=[];if(n){try{l=JSON.parse(n)}catch{}if(!Array.isArray(l))return;let[e]=l;if(!e||e.startsWith(t)&&(0,i.basename)(e)===(0,i.relative)(t,e))return;l=l.map(e=>(0,i.basename)(e))}else l=e instanceof FileList?[...e].map(e=>e.name):[...e].map(e=>{var t;return(null===(t=e.getAsFile())||void 0===t?void 0:t.name)||""}).filter(Boolean);l=l.map(e=>{if(!y[`${t}/${e}`])return e;let n=0,r="";do n+=1,r=`${t}/${(0,i.basename)(e,(0,i.extname)(e))} (${n})${(0,i.extname)(e)}`;while(y[r]);return(0,i.basename)(r)}),(0,f.vi)(t,r.target,y,b,a,l,p)}(0,o.WG)(r,e||E,t,L,!!n)}}}}}}]);