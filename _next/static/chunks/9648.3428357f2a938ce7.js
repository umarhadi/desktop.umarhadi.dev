"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9648,446],{49648:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var n=a(85893),i=a(1864),l=a(67294);let o=a(964).ZP.div.withConfig({componentId:"sc-f808b011-0"})(["iframe{opacity:",";transition:opacity 0.25s ease-in;}.loading{&::before{color:#fff;font-weight:500;mix-blend-mode:normal;text-shadow:1px 2px 3px rgba(0,0,0,50%);}}"],({$loaded:e})=>e?"100%":"0%");var r=a(60446),s=a(54944),f=a(34772),d=a(59140),u=a(78743),c=a(12691),p=a(26550),m=a(48764).Buffer,w=({id:e})=>{let{closeWithTransition:t,processes:{[e]:{libs:[a=""]=[],url:w=""}={}}={}}=(0,u.z)(),{createPath:v,exists:h,readFile:g,updateFolder:y,writeFile:b}=(0,d.o)(),{foregroundId:$,setForegroundId:k,setWallpaper:x}=(0,c.k)(),L=(0,l.useRef)(null),[E,_]=(0,l.useState)(!1),[C,T]=(0,l.useState)(),{prependFileToTitle:j}=(0,f.Z)(e),F=(0,l.useCallback)(e=>t=>{let a=(0,i.join)(p.dA,"wallpaper.png");t.toBlob(async t=>{await b(a,m.from(await (null==t?void 0:t.arrayBuffer())),!0),x(a,e)})},[x,b]),{onDragOver:H,onDrop:Z}=(0,s.Z)({id:e});return(0,l.useEffect)(()=>{j("Untitled")},[j]),(0,l.useEffect)(()=>{if($!==e){var t,a;null===(a=L.current)||void 0===a||null===(t=a.contentWindow)||void 0===t||t.addEventListener("click",()=>k(e),p.K7)}},[$,e,k]),(0,l.useEffect)(()=>{let{contentWindow:a}=L.current||{};if(E&&a&&!C){let n=a.systemHooks.showOpenFileDialog,l=a.file_new;T(a),a.file_new=()=>{j("Untitled"),l()},a.systemHooks.setWallpaperTiled=F("tile"),a.systemHooks.setWallpaperCentered=F("center"),a.systemHooks.showOpenFileDialog=async e=>{let{file:t}=await n(e);return j(t.name),{file:t}},a.close=()=>t(e),a.storage_quota_exceeded=()=>{},a.systemHooks.showSaveFileDialog=async({defaultFileName:e,getBlob:t})=>y(p.Ll,await v(`${e}.png`,p.Ll,m.from(await (await t("image/png")).arrayBuffer()))),a.systemHooks.writeBlobToHandle=async(e,t)=>{await h(e)&&(await b(e,m.from(await t.arrayBuffer()),!0),y((0,i.dirname)(e),(0,i.basename)(e)))},a.addEventListener("dragover",H),a.addEventListener("drop",Z)}},[t,v,h,e,C,E,H,Z,j,F,y,b]),(0,l.useEffect)(()=>{C&&w&&g(w).then(e=>{let t=C.onunhandledrejection;C.onunhandledrejection=e=>{var a;null==t||t(e),(null==e?void 0:null===(a=e.reason)||void 0===a?void 0:a.message)==="either options.data or options.file or options.filePath must be passed"&&j("Untitled")},C.open_from_file(new File([e],w),w),j((0,i.basename)(w))})},[C,j,g,w]),(0,n.jsxs)(o,{$loaded:E,children:[!E&&(0,n.jsx)(r.default,{className:"loading"}),(0,n.jsx)("iframe",{ref:L,height:"100%",id:`jspaint-${e}`,onLoad:()=>_(!0),src:a,title:e,width:"100%",...p.v0})]})}},60446:function(e,t,a){a.r(t);let n=a(964).ZP.div.withConfig({componentId:"sc-29e5eb62-0"})(['cursor:wait;height:100%;width:100%;&::before{color:#fff;content:"Working on it...";display:flex;font-size:12px;justify-content:center;mix-blend-mode:difference;padding-top:18px;}']);t.default=n},54944:function(e,t,a){var n=a(1864),i=a(67294),l=a(46013),o=a(36094),r=a(41893),s=a(59140),f=a(78743),d=a(12691),u=a(26550),c=a(27972);t.Z=({callback:e,directory:t=u.Ll,id:a,onDragLeave:p,onDragOver:m,updatePositions:w})=>{let{url:v}=(0,f.z)(),{iconPositions:h,sortOrders:g,setIconPositions:y}=(0,d.k)(),{mkdirRecursive:b,updateFolder:$,writeFile:k}=(0,s.o)(),x=(0,i.useCallback)(async(e,t,i)=>{if(a){if(t){let l=(0,n.join)(u.Ll,e);if(await b(u.Ll),await k(l,t,!0))return i===r.v.UPDATE_URL&&v(a,l),$(u.Ll,e),(0,n.basename)(l)}else i===r.v.UPDATE_URL&&v(a,e)}return""},[a,b,$,v,k]),{openTransferDialog:L}=(0,l.Z)();return{onDragLeave:p,onDragOver:e=>{null==m||m(e),(0,c.nK)(e)},onDrop:i=>{if(!u.my.has((0,c.RT)(t))){if(w&&i.target instanceof HTMLElement){let{files:e,text:a}=(0,o.p4)(i);if(0===e.length&&""===a)return;let l={x:i.clientX,y:i.clientY},r=[];if(a){try{r=JSON.parse(a)}catch{}if(!Array.isArray(r))return;let[e]=r;if(!e||e.startsWith(t)&&(0,n.basename)(e)===(0,n.relative)(t,e))return;r=r.map(e=>(0,n.basename)(e))}else r=e instanceof FileList?[...e].map(e=>e.name):[...e].map(e=>{var t;return(null===(t=e.getAsFile())||void 0===t?void 0:t.name)||""}).filter(Boolean);r=r.map(e=>{if(!h[`${t}/${e}`])return e;let a=0,i="";do a+=1,i=`${t}/${(0,n.basename)(e,(0,n.extname)(e))} (${a})${(0,n.extname)(e)}`;while(h[i]);return(0,n.basename)(i)}),(0,c.vi)(t,i.target,h,g,l,r,y)}(0,o.WG)(i,e||x,t,L,!!a)}}}}},34772:function(e,t,a){var n=a(67294),i=a(78743),l=a(28272),o=a(26550);t.Z=e=>{let{title:t}=(0,i.z)(),[a]=e.split(o.CC),{title:r}=l.Z[a]||{};return{appendFileToTitle:(0,n.useCallback)((a,n)=>{let i=a?` - ${a}${n?` ${o.xy}`:""}`:"";t(e,`${r}${i}`)},[e,r,t]),prependFileToTitle:(0,n.useCallback)((a,n,i)=>{let l=a?`${n?`${o.xy} `:""}${a}${i?" ":" - "}`:"";t(e,`${l}${r}`)},[e,r,t])}}}}]);