"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4730],{24730:function(t,e,n){n.r(e),n.d(e,{BASE_WEBAMP_OPTIONS:function(){return l},MAIN_WINDOW:function(){return c},PLAYLIST_WINDOW:function(){return d},cleanBufferOnSkinLoad:function(){return p},closeEqualizer:function(){return m},createM3uPlaylist:function(){return O},enabledMilkdrop:function(){return f},focusWindow:function(){return T},getMetadataProvider:function(){return D},getWebampElement:function(){return S},loadButterchurnPreset:function(){return y},loadMilkdropWhenNeeded:function(){return x},parseTrack:function(){return M},setSkinData:function(){return w},tracksFromPlaylist:function(){return P},unFocus:function(){return _},updateWebampPosition:function(){return E}});var i=n(44586),r=n(44558),o=n(46428);const a=new Set(["Flexi - alien fish pond","Geiss - Spiral Artifact"]),s=`${r.Sd}/Documents/Winamp Skins`,u=["localhost",r.Ou.author.url.replace("https://","")].includes(window.location.hostname),l={availableSkins:[{name:"Aqua X",url:`${s}/Aqua_X.wsz`},{name:"Nucleo NLog v2G",url:`${s}/Nucleo_NLog_v102.wsz`},...u?[{defaultName:"Random (Winamp Skin Museum)",loading:!1,get name(){return this.loading||(this.loading=!0,fetch("https://api.webamp.org/graphql",{body:JSON.stringify({query:(t=Math.floor(1e3*Math.random()),`\n  query {\n    skins(filter: APPROVED, first: 1, offset: ${t}) {\n      nodes {\n        download_url\n      }\n    }\n  }\n`)}),headers:{"Content-Type":"application/json"},method:"POST"}).then((async t=>{const{data:e}=await t.json()||{};this.skinUrl=e?.skins?.nodes?.[0]?.download_url,this.loading=!1}))),this.defaultName;var t},skinUrl:"",get url(){return this.skinUrl||`${s}/base-2.91.wsz`}}]:[],{name:"SpyAMP Professional Edition v5",url:`${s}/SpyAMP_Professional_Edition_v5.wsz`}]},h={height:116,width:275},c="#main-window",d="#playlist-window",p=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.skinIsLoaded().then((()=>{e&&(0,o.EK)(e)}))},m=t=>t.store.dispatch({type:"CLOSE_WINDOW",windowId:"equalizer"}),f=t=>t.store.dispatch({open:!1,type:"ENABLE_MILKDROP"}),w=(t,e)=>t.store.dispatch({data:e,type:"SET_SKIN_DATA"}),g=t=>{const{presetHistory:e=[],presets:n=[]}=t.store.getState()?.milkdrop||{},i=Math.floor(Math.random()*n.length),r=n[i];return!r.name||a.has(r.name)||e.slice(-5).includes(i)?g(t):i},y=t=>{const e=g(t);t.store.dispatch({addToHistory:!0,index:e,type:"PRESET_REQUESTED"}),t.store.dispatch({index:e,type:"SELECT_PRESET_AT_INDEX"})};let b=0;const x=t=>{const e=t.store.subscribe((()=>{const{milkdrop:i,windows:r}=t.store.getState();r?.genWindows?.milkdrop?.open&&!i?.butterchurn&&(0,o.mb)(["/Program Files/Webamp/butterchurn.min.js"]).then((()=>{if(!window.butterchurn?.default)return;((t,e)=>{t.store.dispatch({butterchurn:e,type:"GOT_BUTTERCHURN"})})(t,window.butterchurn.default);const{playlist:i,main:o}=r.genWindows||{},{x:a=0,y:s=0}=(i?.open?i?.position:o?.position)||{};t.store.dispatch({positions:{milkdrop:{x:a,y:s+h.height}},type:"UPDATE_WINDOW_POSITIONS"}),e(),t.store.subscribe((()=>{const t=[...document.body.children].find((t=>t.classList?.contains("webamp-desktop")));if(t){const e=document.querySelector("main");e&&([...e.children].forEach((t=>{t.classList?.contains("webamp-desktop")&&t.remove()})),e.append(t))}})),n.e(4519).then(n.t.bind(n,49589,23)).then((e=>{let{default:n}=e;const i=Object.entries(n).map((t=>{let[e,n]=t;return{name:e,preset:n}}));((t,e)=>{t.store.dispatch({presets:e,type:"GOT_BUTTERCHURN_PRESETS"})})(t,i),y(t),(t=>{window.clearInterval(b),b=window.setInterval((()=>{t||window.clearInterval(b),y(t)}),2e4)})(t)}))}))}))},S=()=>document.querySelector("#webamp"),E=(t,e)=>{const{height:n,width:r}=h,{x:o,y:a}=e||(0,i.Rf)({height:2*n,width:r});t.store.dispatch({positions:{main:{x:o,y:a},milkdrop:{x:0-r,y:0-n},playlist:{x:o,y:n+a}},type:"UPDATE_WINDOW_POSITIONS"})},T=(t,e)=>t.store.dispatch({type:"SET_FOCUSED_WINDOW",window:e}),_=t=>t.store.dispatch({type:"SET_FOCUSED_WINDOW",window:""}),M=async(t,e)=>{const{parseBuffer:i}=await Promise.all([n.e(5181),n.e(7181),n.e(9016)]).then(n.bind(n,37181)),{common:{album:a="",artist:s="",title:u=e},format:{duration:l=0}}=await i(t,{mimeType:r.BD,size:t.length},{duration:!0,skipCovers:!0,skipPostHeaders:!0});return{blob:(0,o.V4)(t,"audio/mpeg"),duration:Math.floor(l),metaData:{album:a,artist:s,title:u}}},O=t=>`${["#EXTM3U",...t.map((t=>{const e=t.url?`\n${t.url.toString()}`:"";let n=t.defaultName;return t.metaData?.artist?t.metaData?.title?n=`${t.metaData.artist} - ${t.metaData.title}`:n&&(n=`${t.metaData.artist} - ${n}`):t.metaData?.title&&(n=t.metaData.title),e?`#EXTINF:${t.duration??-1},${n||""}${e}`:""})).filter(Boolean)].join("\n")}\n`,P=async(t,e,i)=>{const{ASX:r,M3U:o,PLS:a}=await n.e(9099).then(n.t.bind(n,59099,23));return({".asx":r,".m3u":o,".pls":a}[e]?.parse(t).filter(Boolean).slice(0,1e3)??[]).map((t=>{let{artist:e="",file:n="",length:r=0,title:o=""}=t;const[a,s]=[e.trim(),o.trim()];return{duration:r>0?r:0,metaData:{album:s||i,artist:a,title:s},url:n}}))},N=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/<!\[CDATA\[|]]>/g,"")},k={"somafm.com":t=>async()=>{const{pathname:e}=new URL(t),[n]=e.replace("/","").split("-"),i=await(await fetch(`https://somafm.com/songs/${n}.xml`,{cache:"no-cache",credentials:"omit",keepalive:!1,mode:"cors",referrerPolicy:"no-referrer",window:null})).text(),r=(new DOMParser).parseFromString(i,"application/xml").querySelector("song"),o=r?.querySelector("artist")?.innerHTML,a=r?.querySelector("title")?.innerHTML;return{artist:N(o),title:N(a)}}},D=t=>{const{host:e}=new URL(t),[,n,i]=e.split(".");return k[`${n}.${i}`]?.(t)}},56961:function(t,e,n){n.d(e,{BS:function(){return a},FC:function(){return r},F_:function(){return i},wV:function(){return o}});const i={bottom:!1,bottomLeft:!1,bottomRight:!1,left:!1,right:!1,top:!1,topLeft:!1,topRight:!1},r={bottom:!0,bottomLeft:!0,bottomRight:!0,left:!0,right:!0,top:!0,topLeft:!0,topRight:!0},o=30,a=166,s={cancel:".cancel",dragHandleClassName:"handle",enableUserSelectHack:!1,minHeight:`${o}px`,minWidth:`${a}px`,resizeHandleStyles:{bottom:{bottom:"-3px",cursor:"ns-resize",height:"6px"},bottomLeft:{bottom:"-3px",cursor:"nesw-resize",height:"12px",left:"-3px",width:"12px"},bottomRight:{bottom:"-3px",cursor:"nwse-resize",height:"12px",right:"-3px",width:"12px"},left:{cursor:"ew-resize",left:"-3px",width:"6px"},right:{cursor:"ew-resize",right:"-3px",width:"6px"},top:{cursor:"ns-resize",height:"6px",top:"-3px"},topLeft:{cursor:"nwse-resize",height:"12px",left:"-3px",top:"-3px",width:"12px"},topRight:{cursor:"nesw-resize",height:"12px",right:"-3px",top:"-3px",width:"12px"}}};e.ZP=s},44586:function(t,e,n){n.d(e,{Rf:function(){return s},b$:function(){return h},hu:function(){return a},ix:function(){return l},mZ:function(){return u}});var i=n(56961),r=n(44558),o=n(46428);const a=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const[a]=t.split(r.CC),s=`${a}${r.CC}`,u=n.find((t=>t.startsWith(s)))||"",{componentWindow:l}=e?.[u]||{},{x:h=0,y:c=0,width:d=0,height:p=0}=l?.getBoundingClientRect()||{};return h+i+d>(0,o.E9)()||c+i+p>(0,o.sI)()||!h&&!c?void 0:{x:h+i,y:c+i}},s=t=>{let{height:e,width:n}=t;const[i,a]=[(0,o.sI)(),(0,o.E9)()];return{x:Math.floor(a/2-(0,o.Vy)(n)/2),y:Math.floor((i-r.bK)/2-(0,o.Vy)(e)/2)}},u={BOTTOM:15,LEFT:150,RIGHT:50,TOP:15},l=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{position:i,size:r}=t||{},{x:a=0,y:s=0}=i||{},{height:l=0,width:h=0}=r||{};return n?a+u.RIGHT>e.x||a+(0,o.Vy)(h)-u.LEFT<0||s+u.BOTTOM>e.y||s+u.TOP<0:a<0||s<0||a+(0,o.Vy)(h)>e.x||s+(0,o.Vy)(l)>e.y},h=(t,e)=>{const n=Number(t.height),a=Number(t.width),[s,u]=[(0,o.sI)(),(0,o.E9)()],l=s-r.bK,h=Math.max(i.wV,Math.min(n,l)),c=Math.max(i.BS,Math.min(a,u));if(!e)return{height:h,width:c};const d=n===h,p=a===c;return d||p?d?p?{height:h,width:c}:{height:Math.round(h/(a/c)),width:c}:{height:h,width:Math.round(c/(n/h))}:n>a?{height:h,width:Math.round(c/(l/h))}:{height:Math.round(h/(u/c)),width:c}}}}]);